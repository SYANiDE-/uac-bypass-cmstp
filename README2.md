Front-run with an 'force amsiOpenSession falure' AMSI bypass.
Iterate over the compiled dll with ThreatCheck to iron out Defender detections https://github.com/rasta-mouse/ThreatCheck 
